# 멱등성(Idempotence) 원칙 설명

멱등성(Idempotence)은 컴퓨팅 및 수학에서 **여러 번 수행해도 결과가 동일한 연산의 속성**을 의미합니다. 즉, 어떤 작업을 한 번 수행하든 여러 번 수행하든, 시스템의 **최종 상태는 항상 같습니다.**

## 왜 중요한가요?

멱등성은 특히 분산 시스템, API 설계, 자동화된 스크립트, 그리고 방금 전에 이야기했던 **개발 환경 설정 스크립트**와 같은 분야에서 매우 중요합니다.

1.  **안전한 재시도 (Safe Retries)**: 네트워크 오류나 시스템 장애로 인해 작업이 실패했는지 알 수 없을 때, 멱등적인 작업은 걱정 없이 재시도할 수 있습니다. 예를 들어, 결제 요청이 두 번 처리될까 봐 걱정할 필요 없이 안전하게 재시도할 수 있습니다.
2.  **예측 가능성 (Predictability)**: 동일한 입력에 대해 항상 동일한 결과를 보장하므로, 시스템의 동작을 예측하기 쉽고 디버깅이 용이해집니다.
3.  **시스템 일관성 (System Consistency)**: 작업을 반복 실행해도 시스템의 상태가 망가지지 않고 일관성을 유지할 수 있습니다.
4.  **자동화 및 스크립트의 안정성**: 개발 환경 설정 스크립트처럼 여러 번 실행될 수 있는 스크립트의 경우, 멱등성을 지키면 이미 설치된 것을 다시 설치하려고 시도해도 문제가 발생하지 않고, 필요한 경우에만 업데이트하거나 설치를 진행합니다.

## 멱등성의 예시

* **HTTP PUT 메서드**: RESTful API에서 `PUT` 요청은 특정 리소스를 생성하거나 **업데이트**하는 데 사용됩니다. 동일한 `PUT` 요청을 여러 번 보내도, 리소스는 한 번만 생성되거나 마지막으로 보낸 내용으로 업데이트되므로 최종 상태는 같습니다. (반면 `POST`는 매번 새로운 리소스를 생성할 수 있어 멱등적이지 않을 수 있습니다.)
* **데이터베이스 `UPDATE`**: 특정 `WHERE` 절을 사용하여 레코드를 업데이트하는 SQL `UPDATE` 문은 여러 번 실행해도 최종적으로 해당 레코드는 한 번만 변경됩니다.
* **파일 삭제**: 특정 파일을 삭제하는 작업은 해당 파일이 존재하든 안 하든, 최종적으로는 파일이 없는 상태가 되므로 멱등적입니다.
* **환경 설정 스크립트**: 우리가 만든 `apt install` 스크립트가 좋은 예시입니다. `shellcheck`를 설치하는 명령어를 한 번 실행하든 열 번 실행하든, `shellcheck`는 결국 한 번만 설치되거나 최신 상태로 유지됩니다.

## 멱등성을 고려한 설계

멱등성을 고려하여 시스템을 설계하려면, 상태 변경을 일으키는 작업이 반복될 때 어떻게 처리될지 신중하게 생각해야 합니다. 단순히 "실행"하는 것이 아니라 "목표 상태로 만들기"라는 관점에서 접근하면 멱등적인 설계를 하는 데 도움이 됩니다.

멱등성은 복잡한 시스템의 안정성과 신뢰성을 높이는 데 필수적인 개념입니다.